<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ROBOTMAN Chapter 1</title>
  <link rel="icon" type="image/x-icon" href="chukler.ico">

  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: #000000;
      color: white;
    }

    /* scroll container */
    .reader {
      height: 100vh;
      overflow-y: auto;
      scroll-snap-type: y mandatory;
      scrollbar-width: none;
      padding-right: 90px;
    }

    .page {
      height: 100vh;
      scroll-snap-align: center;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #151515;
    }

    .page img {
      max-height: 100%;
      max-width: 100%;
    }

    .controller {
      position: fixed;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      width: 70px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      max-height: 90vh;
    }

    button {
      width: 40px;
      height: 40px;
      font-size: 20px;
      cursor: pointer;
    }

    .thumbs {
      display: flex;
      flex-direction: column;
      gap: 10px;
      max-height: 300px;
      scrollbar-width: none;
      overflow-y: auto;
      flex: 1;
    }

    .thumb {
      width: 50px;
      height: 70px;
      background-size: cover;
      background-position: center;
      border-radius: 10px;
      border: 2px solid transparent;
      cursor: pointer;
      flex-shrink: 0;
    }

    .thumb.active {
      border-color: deepskyblue;
    }

    .page img {
      max-height: 100%;
      max-width: 100%;
      cursor: grab;
      touch-action: none;
      user-select: none;
      -webkit-user-drag: none;
      transition: transform 0.15s ease-out;
    }

    .page img {
      -webkit-user-drag: none;
      pointer-events: auto;
    }
  </style>
</head>

<body>

  <div class="reader" id="reader">
    <section class="page">
      <img src="assets\Comic\ROBOTMAN\ROBOTMAN1\cover.png" alt="Cover">
    </section>
    <section class="page">
      <img src="assets\Comic\ROBOTMAN\ROBOTMAN1\cov.png" alt="Word">
    </section>
    <section class="page">
      <img src="assets\Comic\ROBOTMAN\ROBOTMAN1\ch1p1.png" alt="Page 1">
    </section>
    <section class="page">
      <img src="assets\Comic\ROBOTMAN\ROBOTMAN1\ch1p2.png" alt="Page 2">
    </section>
    <section class="page">
      <img src="assets\Comic\ROBOTMAN\ROBOTMAN1\ch1p3.png" alt="Page 3">
    </section>
    <section class="page">
      <img src="assets\Comic\ROBOTMAN\ROBOTMAN1\ch1p4.png" alt="Page 4">
    </section>
    <section class="page">
      <img src="assets\Comic\ROBOTMAN\ROBOTMAN1\ch1p5.png" alt="Page 5">
    </section>
    <section class="page">
      <img src="assets\Comic\ROBOTMAN\ROBOTMAN1\ch1p6.png" alt="Page 6">
    </section>
    <section class="page">
      <img src="assets\Comic\ROBOTMAN\ROBOTMAN1\ch1p7.png" alt="Page 7">
    </section>
    <section class="page">
      <img src="assets\Comic\ROBOTMAN\ROBOTMAN1\ch1p8.png" alt="Page 8">
    </section>
    <section class="page">
      <img src="assets\Comic\ROBOTMAN\ROBOTMAN1\ch1p9.png" alt="Page 9">
    </section>
    <section class="page">
      <img src="assets\Comic\ROBOTMAN\ROBOTMAN1\ch1p10.png" alt="Page 10">
    </section>
    <section class="page">
      <img src="assets\Comic\ROBOTMAN\ROBOTMAN1\ch1p11.png" alt="Page 11">
    </section>
    <section class="page">
      <img src="assets\Comic\ROBOTMAN\ROBOTMAN1\ch1p12.png" alt="Page 12">
    </section>
    <section class="page">
      <img src="assets\Comic\ROBOTMAN\ROBOTMAN1\endcov.png" alt="Word">
    </section>
  </div>

  <div class="controller">
    <button id="btn-prev">↑</button>
    <div class="thumbs" id="thumbs"></div>
    <button id="btn-next">↓</button>
    <div id="indicator">1 / 4</div>
  </div>

  <script>
    const pages = [...document.querySelectorAll('.page')];
    const thumbs = document.getElementById('thumbs');
    const indicator = document.getElementById('indicator');
    const total = pages.length;
    let active = 0;

    function makeZoomable(img) {
      img.addEventListener("dragstart", e => e.preventDefault());

      let scale = 1;
      let startX = 0, startY = 0;
      let currentX = 0, currentY = 0;
      let dragging = false;

      let lastTouchDist = 0;

      function applyTransform() {
        img.style.transform = `translate(${currentX}px, ${currentY}px) scale(${scale})`;
      }

      function resetZoom() {
        scale = 1;
        currentX = 0;
        currentY = 0;
        applyTransform();
      }

      img.resetZoom = resetZoom;

      img.addEventListener("dblclick", () => {
        scale = scale === 1 ? 2 : 1;
        currentX = 0; currentY = 0;
        applyTransform();
      });

      img.addEventListener("mousedown", e => {
        if (scale === 1) return;
        dragging = true;
        startX = e.clientX - currentX;
        startY = e.clientY - currentY;
        img.style.cursor = "grabbing";
      });

      window.addEventListener("mousemove", e => {
        if (!dragging) return;
        currentX = e.clientX - startX;
        currentY = e.clientY - startY;
        applyTransform();
      });

      window.addEventListener("mouseup", () => {
        dragging = false;
        img.style.cursor = "grab";
      });

      img.addEventListener("touchstart", e => {
        if (e.touches.length === 1) {
          startX = e.touches[0].clientX - currentX;
          startY = e.touches[0].clientY - currentY;
        } else if (e.touches.length === 2) {
          const dx = e.touches[0].clientX - e.touches[1].clientX;
          const dy = e.touches[0].clientY - e.touches[1].clientY;
          lastTouchDist = Math.hypot(dx, dy);
        }
      });

      img.addEventListener("touchmove", e => {
        e.preventDefault();

        if (e.touches.length === 1 && scale > 1) {
          currentX = e.touches[0].clientX - startX;
          currentY = e.touches[0].clientY - startY;
        }

        if (e.touches.length === 2) {
          const dx = e.touches[0].clientX - e.touches[1].clientX;
          const dy = e.touches[0].clientY - e.touches[1].clientY;
          const dist = Math.hypot(dx, dy);

          let delta = dist - lastTouchDist;
          lastTouchDist = dist;

          scale += delta * 0.005;
          scale = Math.min(Math.max(scale, 1), 4);
        }

        applyTransform();
      }, { passive: false });

      return img;
    }

    pages.forEach(p => {
      const img = p.querySelector("img");
      makeZoomable(img);
    });


    function scrollToPage(i) {
      i = Math.max(0, Math.min(total - 1, i));

      const oldImg = pages[active].querySelector("img");
      if (oldImg && oldImg.resetZoom) oldImg.resetZoom();

      active = i;
      pages[i].scrollIntoView({ behavior: "smooth", block: "center" });

      setTimeout(() => {
        const newImg = pages[i].querySelector("img");
        if (newImg && newImg.resetZoom) newImg.resetZoom();
      }, 150);

      updateUI();
    }


    function updateUI() {
      [...thumbs.children].forEach((t, i) =>
        t.classList.toggle("active", i === active)
      );
      indicator.textContent = `${active + 1} / ${total}`;
    }

    pages.forEach((p, i) => {
      const img = p.querySelector("img");
      const t = document.createElement("div");
      t.className = "thumb";

      if (img) {
        t.style.backgroundImage = `url("${img.src}")`;
        t.style.backgroundSize = "cover";
        t.style.backgroundPosition = "center";
      }

      t.dataset.index = i;
      t.addEventListener("click", () => scrollToPage(i));
      thumbs.appendChild(t);
    });

    document.getElementById("btn-prev").onclick = () => scrollToPage(active - 1);
    document.getElementById("btn-next").onclick = () => scrollToPage(active + 1);

    const reader = document.getElementById("reader");
    let timeout;
    reader.addEventListener("scroll", () => {
      clearTimeout(timeout);
      timeout = setTimeout(() => {
        let closest = 0, best = Infinity;
        const center = innerHeight / 2;
        pages.forEach((p, i) => {
          const r = p.getBoundingClientRect();
          const d = Math.abs(r.top + r.height / 2 - center);
          if (d < best) { best = d; closest = i; }
        });
        if (closest !== active) {
          const prevImg = pages[active].querySelector("img");
          if (prevImg && prevImg.resetZoom) prevImg.resetZoom();

          active = closest;

          const newImg = pages[active].querySelector("img");
          if (newImg && newImg.resetZoom) newImg.resetZoom();

          updateUI();
        }
      }, 80);
    });

    updateUI();
  </script>

</body>

</html>